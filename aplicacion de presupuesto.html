<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Presupuesto</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet"/>

</head>
<body>
  <div class="container">
    <div class="top">
      <h1 id="tituloPresupuesto">Presupuesto</h1>
      <p id="balance">+ 0.00</p>
      <div class="box ingresos">
        <span>INGRESOS :</span>
        <span id="ingresosTotal">+0.00</span>
      </div>
      <div class="box egresos">
        <span>EGRESOS:</span>
        <span id="egresosTotal">-0.00</span>
      </div>
      <div class="porcentaje">
        Porcentaje de gastos: <span id="porcentajeGastos">0%</span>
      </div>
    </div>
    <div class="bottom">
      <div class="formulario">
        <h3>Transacción</h3>
        <select id="tipo">
          <option value="ingreso">Ingreso</option>
          <option value="egreso">Egreso</option>
        </select>
        <input type="text" id="descripcion" placeholder="Descripción" />
        <input type="number" id="monto" placeholder="Monto" />
        <button onclick="agregarTransaccion()">Agregar</button>
      </div>
      <div class="transacciones">
        <div class="tabs">
          <button class="active" onclick="mostrar('ingreso')">Ingresos</button>
          <button class="inactive" onclick="mostrar('egreso')">Egresos</button>
        </div>
        <div class="lista" id="listaTransacciones">
          <!-- Transacciones se agregarán aquí -->
        </div>
      </div>
    </div>
  </div>

  <script>
    // Mostrar mes y año actual
    const titulo = document.getElementById("tituloPresupuesto");
    const fecha = new Date();
    const opcionesMes = { month: 'long' };
    const nombreMes = fecha.toLocaleDateString('es-ES', opcionesMes);
    const año = fecha.getFullYear();
    titulo.textContent = `Presupuesto de ${nombreMes.charAt(0).toUpperCase() + nombreMes.slice(1)} ${año}`;

    const lista = document.getElementById("listaTransacciones");
    const balanceEl = document.getElementById("balance");
    const ingresosEl = document.getElementById("ingresosTotal");
    const egresosEl = document.getElementById("egresosTotal");
    const porcentajeEl = document.getElementById("porcentajeGastos");

    let transacciones = [];

    function agregarTransaccion() {
      const tipo = document.getElementById("tipo").value;
      const descripcion = document.getElementById("descripcion").value;
      const monto = parseFloat(document.getElementById("monto").value);

      if (!descripcion || isNaN(monto) || monto <= 0) {
        alert("Por favor completa todos los campos correctamente.");
        return;
      }

      transacciones.push({ tipo, descripcion, monto });
      document.getElementById("descripcion").value = "";
      document.getElementById("monto").value = "";
      actualizarVista();
    }

    function actualizarVista(filtro = "ingreso") {
      lista.innerHTML = "";

      let ingresos = 0, egresos = 0;

      transacciones.forEach(t => {
        if (t.tipo === "ingreso") ingresos += t.monto;
        else egresos += t.monto;

        if (t.tipo === filtro) {
          const item = document.createElement("div");
          item.classList.add("item");
          item.innerHTML = `<span>${t.descripcion}</span><span>${t.tipo === "ingreso" ? "+" : "-"} ${t.monto.toFixed(2)}</span>`;
          lista.appendChild(item);
        }
      });

      const balance = ingresos - egresos;
      const porcentaje = ingresos > 0 ? Math.round((egresos / ingresos) * 100) : 0;

      balanceEl.textContent = (balance >= 0 ? "+ " : "- ") + Math.abs(balance).toFixed(2);
      ingresosEl.textContent = "+ " + ingresos.toFixed(2);
      egresosEl.textContent = "- " + egresos.toFixed(2);
      porcentajeEl.textContent = porcentaje + "%";
    }

    function mostrar(filtro) {
      document.querySelectorAll(".tabs button").forEach(btn => {
        btn.classList.remove("active");
        btn.classList.add("inactive");
      });
      event.target.classList.add("active");
      event.target.classList.remove("inactive");
      actualizarVista(filtro);
    }

    actualizarVista();
  </script>
</body>
</html>